https://bugs.gentoo.org/538300

From 3da25ddd011c169b9857ed2f6a2e82988f059ba5 Mon Sep 17 00:00:00 2001
From: Mike Frysinger <vapier@gentoo.org>
Date: Fri, 3 Apr 2015 02:39:21 -0400
Subject: [PATCH] make perl & examples optional

The normal bison program does not require perl to build or run, so lets
soften that requirement in the configure script.  We now warn if its not
found, and we make the examples logic depend on that.

* configure.ac: Change AC_MSG_ERROR to AC_MSG_WARN for perl.
Add an --enable-examples flag.
* Makefile.am: Only include examples/local.mk when ENABLE_EXAMPLES.
---
 Makefile.am  |  2 ++
 configure.ac | 21 ++++++++++++++++++++-
 2 files changed, 22 insertions(+), 1 deletion(-)

#diff -ru bison-3.0.4.orig/configure.ac bison-3.0.4/configure.ac
#--- bison-3.0.4.orig/configure.ac	2015-04-10 18:21:18.779217161 +0200
#+++ bison-3.0.4/configure.ac	2015-04-10 18:23:34.412306149 +0200
#@@ -179,12 +179,31 @@
 supports -g, otherwise to "".])
 AC_PATH_PROG([PERL], [perl])
 if test -z "$PERL"; then
-   AC_MSG_ERROR([perl not found])
+  AC_MSG_WARN([perl required for the testsuites])
 fi
 AM_MISSING_PROG([HELP2MAN], [help2man])
 AC_PATH_PROG([XSLTPROC], [xsltproc])
 AC_SUBST([XSLTPROC])
 
+AC_ARG_ENABLE([examples],
+  [AC_HELP_STRING([--disable-examples],
+     [do not build and install examples])])
+# Enable the examles by default if perl is available.
+case $enable_examples in
+no) ;;
+yes)
+  if test -z "$PERL"; then
+    AC_MSG_ERROR([perl required for the examples])
+  fi
+  ;;
+*)
+  if test -n "$PERL"; then
+    enable_examples=yes
+  fi
+  ;;
+esac
+AM_CONDITIONAL([ENABLE_EXAMPLES], [test "xenable_examples" = xyes])
+
 # Checks for header files.
 AC_CHECK_HEADERS_ONCE([locale.h])
 
diff -ru bison-3.0.4.orig/configure bison-3.0.4/configure
--- bison-3.0.4.orig/configure	2015-04-10 18:21:18.779217161 +0200
+++ bison-3.0.4/configure	2015-04-10 18:23:53.018939296 +0200
@@ -1693,6 +1693,8 @@
 ALLOCA
 GL_COND_LIBTOOL_FALSE
 GL_COND_LIBTOOL_TRUE
+ENABLE_EXAMPLES_FALSE
+ENABLE_EXAMPLES_TRUE
 XSLTPROC
 HELP2MAN
 PERL
@@ -1837,6 +1839,7 @@
 enable_threads
 enable_gcc_warnings
 enable_yacc
+enable_examples
 enable_assert
 with_gnu_ld
 enable_rpath
@@ -2493,6 +2496,7 @@
                            Also, issue synclines from the examples/ to
                            the corresponding source in the Texinfo doc.
   --disable-yacc          do not build a yacc command or an -ly library
+  --disable-examples      do not build and install examples
   --disable-assert        turn off assertions
   --disable-rpath         do not hardcode runtime library paths
   --disable-nls           do not use Native Language Support
@@ -8935,7 +8939,8 @@
 
 
 if test -z "$PERL"; then
-   as_fn_error $? "perl not found" "$LINENO" 5
+  { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: perl required for the testsuites" >&5
+$as_echo "$as_me: WARNING: perl required for the testsuites" >&2;}
 fi
 
 HELP2MAN=${HELP2MAN-"${am_missing_run}help2man"}
@@ -8982,6 +8987,34 @@
 
 
 
+# Check whether --enable-examples was given.
+if test "${enable_examples+set}" = set; then :
+  enableval=$enable_examples;
+fi
+
+# Enable the examles by default if perl is available.
+case $enable_examples in
+no) ;;
+yes)
+  if test -z "$PERL"; then
+    as_fn_error $? "perl required for the examples" "$LINENO" 5
+  fi
+  ;;
+*)
+  if test -n "$PERL"; then
+    enable_examples=yes
+  fi
+  ;;
+esac
+ if test "xenable_examples" = xyes; then
+  ENABLE_EXAMPLES_TRUE=
+  ENABLE_EXAMPLES_FALSE='#'
+else
+  ENABLE_EXAMPLES_TRUE='#'
+  ENABLE_EXAMPLES_FALSE=
+fi
+
+
 # Checks for header files.
 
 
@@ -37293,23 +37326,23 @@
         if $JAVAC --version 2>/dev/null | sed -e 1q | grep gcj > /dev/null; then
             if $JAVAC --version 2>/dev/null | sed -e 's,^[^0-9]*,,' -e 1q | sed -e '/^4\.[012]/d' | grep '^[4-9]' >/dev/null; then
                         rm -f conftest.class
-        if { echo "$as_me:37296: $JAVAC -d . conftest.java" >&5
+        if { echo "$as_me:37329: $JAVAC -d . conftest.java" >&5
              $JAVAC -d . conftest.java >&5 2>&1
            } \
            && test -f conftest.class \
            && expr `func_classfile_version conftest.class` '<=' $cfversion >/dev/null 2>&5; then
                     rm -f conftest.class
           rm -f conftestfail.class
-          if { echo "$as_me:37303: $JAVAC -fsource=$source_version -d . conftest.java" >&5
+          if { echo "$as_me:37336: $JAVAC -fsource=$source_version -d . conftest.java" >&5
                $JAVAC -fsource="$source_version" -d . conftest.java >&5 2>&1
              } \
              && test -f conftest.class \
              && expr `func_classfile_version conftest.class` '<=' $cfversion >/dev/null 2>&5 \
-             && { echo "$as_me:37308: $JAVAC -d . conftestfail.java" >&5
+             && { echo "$as_me:37341: $JAVAC -d . conftestfail.java" >&5
                   $JAVAC -d . conftestfail.java >&5 2>&1
                 } \
              && test -f conftestfail.class \
-             && ! { echo "$as_me:37312: $JAVAC -fsource=$source_version -d . conftestfail.java" >&5
+             && ! { echo "$as_me:37345: $JAVAC -fsource=$source_version -d . conftestfail.java" >&5
                     $JAVAC -fsource="$source_version" -d . conftestfail.java >&5 2>&1
                   }; then
             CONF_JAVAC="$JAVAC -fsource=$source_version"
@@ -37323,7 +37356,7 @@
         else
                     rm -f conftest.class
           rm -f conftestfail.class
-          if { echo "$as_me:37326: $JAVAC -fsource=$source_version -ftarget=$target_version -d . conftest.java" >&5
+          if { echo "$as_me:37359: $JAVAC -fsource=$source_version -ftarget=$target_version -d . conftest.java" >&5
                $JAVAC -fsource="$source_version" -ftarget="$target_version" -d . conftest.java >&5 2>&1
              } \
              && test -f conftest.class \
@@ -37336,7 +37369,7 @@
       else
                 if test "$target_version" = 1.4 && test "$source_version" = 1.4; then
                     rm -f conftest.class
-          if { echo "$as_me:37339: $JAVAC -d . conftest.java" >&5
+          if { echo "$as_me:37372: $JAVAC -d . conftest.java" >&5
                $JAVAC -d . conftest.java >&5 2>&1
              } \
              && test -f conftest.class; then
@@ -37348,7 +37381,7 @@
           if test "$target_version" = 1.4 && test "$source_version" = 1.3; then
                                     javac_works=
             rm -f conftest.class
-            if { echo "$as_me:37351: $JAVAC -d . conftest.java" >&5
+            if { echo "$as_me:37384: $JAVAC -d . conftest.java" >&5
                  $JAVAC -d . conftest.java >&5 2>&1
                } \
                && test -f conftest.class; then
@@ -37356,7 +37389,7 @@
             fi
             javac_noassert_works=
             rm -f conftest.class
-            if { echo "$as_me:37359: $JAVAC -fno-assert -d . conftest.java" >&5
+            if { echo "$as_me:37392: $JAVAC -fno-assert -d . conftest.java" >&5
                  $JAVAC -fno-assert -d . conftest.java >&5 2>&1
                } \
                && test -f conftest.class; then
@@ -37364,11 +37397,11 @@
             fi
             if test -n "$javac_works" && test -n "$javac_noassert_works"; then
               rm -f conftestfail.class
-              if { echo "$as_me:37367: $JAVAC -d . conftestfail.java" >&5
+              if { echo "$as_me:37400: $JAVAC -d . conftestfail.java" >&5
                    $JAVAC -d . conftestfail.java >&5 2>&1
                  } \
                  && test -f conftestfail.class \
-                 && ! { echo "$as_me:37371: $JAVAC -fno-assert -d . conftestfail.java" >&5
+                 && ! { echo "$as_me:37404: $JAVAC -fno-assert -d . conftestfail.java" >&5
                         $JAVAC -fno-assert -d . conftestfail.java >&5 2>&1
                       }; then
                                 javac_works=
@@ -37390,23 +37423,23 @@
       fi
     else
                   rm -f conftest.class
-      if { echo "$as_me:37393: $JAVAC -d . conftest.java" >&5
+      if { echo "$as_me:37426: $JAVAC -d . conftest.java" >&5
            $JAVAC -d . conftest.java >&5 2>&1
          } \
          && test -f conftest.class \
          && expr `func_classfile_version conftest.class` '<=' $cfversion >/dev/null 2>&5; then
                 rm -f conftest.class
         rm -f conftestfail.class
-        if { echo "$as_me:37400: $JAVAC -source $source_version -d . conftest.java" >&5
+        if { echo "$as_me:37433: $JAVAC -source $source_version -d . conftest.java" >&5
              $JAVAC -source "$source_version" -d . conftest.java >&5 2>&1
            } \
            && test -f conftest.class \
            && expr `func_classfile_version conftest.class` '<=' $cfversion >/dev/null 2>&5 \
-           && { echo "$as_me:37405: $JAVAC -d . conftestfail.java" >&5
+           && { echo "$as_me:37438: $JAVAC -d . conftestfail.java" >&5
                 $JAVAC -d . conftestfail.java >&5 2>&1
               } \
            && test -f conftestfail.class \
-           && ! { echo "$as_me:37409: $JAVAC -source $source_version -d . conftestfail.java" >&5
+           && ! { echo "$as_me:37442: $JAVAC -source $source_version -d . conftestfail.java" >&5
                   $JAVAC -source "$source_version" -d . conftestfail.java >&5 2>&1
                 }; then
           CONF_JAVAC="$JAVAC -source $source_version"
@@ -37419,23 +37452,23 @@
         fi
       else
                         rm -f conftest.class
-        if { echo "$as_me:37422: $JAVAC -target $target_version -d . conftest.java" >&5
+        if { echo "$as_me:37455: $JAVAC -target $target_version -d . conftest.java" >&5
              $JAVAC -target "$target_version" -d . conftest.java >&5 2>&1
            } \
            && test -f conftest.class \
            && expr `func_classfile_version conftest.class` '<=' $cfversion >/dev/null 2>&5; then
                     rm -f conftest.class
           rm -f conftestfail.class
-          if { echo "$as_me:37429: $JAVAC -target $target_version -source $source_version -d . conftest.java" >&5
+          if { echo "$as_me:37462: $JAVAC -target $target_version -source $source_version -d . conftest.java" >&5
                $JAVAC -target "$target_version" -source "$source_version" -d . conftest.java >&5 2>&1
              } \
              && test -f conftest.class \
              && expr `func_classfile_version conftest.class` '<=' $cfversion >/dev/null 2>&5 \
-             && { echo "$as_me:37434: $JAVAC -target $target_version -d . conftestfail.java" >&5
+             && { echo "$as_me:37467: $JAVAC -target $target_version -d . conftestfail.java" >&5
                   $JAVAC -target "$target_version" -d . conftestfail.java >&5 2>&1
                 } \
              && test -f conftestfail.class \
-             && ! { echo "$as_me:37438: $JAVAC -target $target_version -source $source_version -d . conftestfail.java" >&5
+             && ! { echo "$as_me:37471: $JAVAC -target $target_version -source $source_version -d . conftestfail.java" >&5
                     $JAVAC -target "$target_version" -source "$source_version" -d . conftestfail.java >&5 2>&1
                   }; then
             CONF_JAVAC="$JAVAC -target $target_version -source $source_version"
@@ -37448,7 +37481,7 @@
           fi
         else
                                         rm -f conftest.class
-          if { echo "$as_me:37451: $JAVAC -target $target_version -source $source_version -d . conftest.java" >&5
+          if { echo "$as_me:37484: $JAVAC -target $target_version -source $source_version -d . conftest.java" >&5
                $JAVAC -target "$target_version" -source "$source_version" -d . conftest.java >&5 2>&1
              } \
              && test -f conftest.class \
@@ -37566,28 +37599,28 @@
 
                 if test -z "$HAVE_JAVACOMP" && test -n "$HAVE_GCJ_IN_PATH"; then
             if gcj --version 2>/dev/null | sed -e 's,^[^0-9]*,,' -e 1q | sed -e '/^3\.[01]/d' | grep '^[3-9]' >/dev/null; then
-                if { echo "$as_me:37569: gcj -C -d . conftestlib.java" >&5
+                if { echo "$as_me:37602: gcj -C -d . conftestlib.java" >&5
              gcj -C -d . conftestlib.java >&5 2>&1
            }; then
                     if gcj --version 2>/dev/null | sed -e 's,^[^0-9]*,,' -e 1q | sed -e '/^4\.[012]/d' | grep '^[4-9]' >/dev/null; then
                                     rm -f conftest.class
-            if { echo "$as_me:37574: gcj -C -d . conftest.java" >&5
+            if { echo "$as_me:37607: gcj -C -d . conftest.java" >&5
                  gcj -C -d . conftest.java >&5 2>&1
                } \
                && test -f conftest.class \
                && expr `func_classfile_version conftest.class` '<=' $cfversion >/dev/null 2>&5; then
                             rm -f conftest.class
               rm -f conftestfail.class
-              if { echo "$as_me:37581: gcj -C -fsource=$source_version -d . conftest.java" >&5
+              if { echo "$as_me:37614: gcj -C -fsource=$source_version -d . conftest.java" >&5
                    gcj -C -fsource="$source_version" -d . conftest.java >&5 2>&1
                  } \
                  && test -f conftest.class \
                  && expr `func_classfile_version conftest.class` '<=' $cfversion >/dev/null 2>&5 \
-                 && { echo "$as_me:37586: gcj -C -d . conftestfail.java" >&5
+                 && { echo "$as_me:37619: gcj -C -d . conftestfail.java" >&5
                       gcj -C -d . conftestfail.java >&5 2>&1
                     } \
                  && test -f conftestfail.class \
-                 && ! { echo "$as_me:37590: gcj -C -fsource=$source_version -d . conftestfail.java" >&5
+                 && ! { echo "$as_me:37623: gcj -C -fsource=$source_version -d . conftestfail.java" >&5
                         gcj -C -fsource="$source_version" -d . conftestfail.java >&5 2>&1
                       }; then
                 CONF_JAVAC="gcj -C -fsource=$source_version"
@@ -37601,7 +37634,7 @@
             else
                             rm -f conftest.class
               rm -f conftestfail.class
-              if { echo "$as_me:37604: gcj -C -fsource=$source_version -ftarget=$target_version -d . conftest.java" >&5
+              if { echo "$as_me:37637: gcj -C -fsource=$source_version -ftarget=$target_version -d . conftest.java" >&5
                    gcj -C -fsource="$source_version" -ftarget="$target_version" -d . conftest.java >&5 2>&1
                  } \
                  && test -f conftest.class \
@@ -37614,7 +37647,7 @@
           else
                                                 if test "$target_version" = 1.4 && test "$source_version" = 1.4; then
               rm -f conftest.class
-              if { echo "$as_me:37617: gcj -C -d . conftest.java" >&5
+              if { echo "$as_me:37650: gcj -C -d . conftest.java" >&5
                    gcj -C -d . conftest.java >&5 2>&1
                  } \
                  && test -f conftest.class; then
@@ -37625,7 +37658,7 @@
             else
               if test "$target_version" = 1.4 && test "$source_version" = 1.3; then
                                                 rm -f conftest.class
-                if { echo "$as_me:37628: gcj -C -fno-assert -d . conftest.java" >&5
+                if { echo "$as_me:37661: gcj -C -fno-assert -d . conftest.java" >&5
                      gcj -C -fno-assert -d . conftest.java >&5 2>&1
                    } \
                    && test -f conftest.class; then
@@ -37634,7 +37667,7 @@
                   HAVE_JAVACOMP=1
                 else
                   rm -f conftest.class
-                  if { echo "$as_me:37637: gcj -C -d . conftest.java" >&5
+                  if { echo "$as_me:37670: gcj -C -d . conftest.java" >&5
                        gcj -C -d . conftest.java >&5 2>&1
                      } \
                      && test -f conftest.class; then
@@ -37653,23 +37686,23 @@
             if { javac -version >/dev/null 2>/dev/null || test $? -le 2; } \
          && ( if javac -help 2>&1 >/dev/null | grep at.dms.kjc.Main >/dev/null && javac -help 2>/dev/null | grep 'released.*2000' >/dev/null ; then exit 1; else exit 0; fi ); then
                                 rm -f conftest.class
-        if { echo "$as_me:37656: javac -d . conftest.java" >&5
+        if { echo "$as_me:37689: javac -d . conftest.java" >&5
              javac -d . conftest.java >&5 2>&1
            } \
            && test -f conftest.class \
            && expr `func_classfile_version conftest.class` '<=' $cfversion >/dev/null 2>&5; then
                     rm -f conftest.class
           rm -f conftestfail.class
-          if { echo "$as_me:37663: javac -source $source_version -d . conftest.java" >&5
+          if { echo "$as_me:37696: javac -source $source_version -d . conftest.java" >&5
                javac -source "$source_version" -d . conftest.java >&5 2>&1
              } \
              && test -f conftest.class \
              && expr `func_classfile_version conftest.class` '<=' $cfversion >/dev/null 2>&5 \
-             && { echo "$as_me:37668: javac -d . conftestfail.java" >&5
+             && { echo "$as_me:37701: javac -d . conftestfail.java" >&5
                   javac -d . conftestfail.java >&5 2>&1
                 } \
              && test -f conftestfail.class \
-             && ! { echo "$as_me:37672: javac -source $source_version -d . conftestfail.java" >&5
+             && ! { echo "$as_me:37705: javac -source $source_version -d . conftestfail.java" >&5
                     javac -source "$source_version" -d . conftestfail.java >&5 2>&1
                   }; then
             CONF_JAVAC="javac -source $source_version"
@@ -37682,23 +37715,23 @@
           fi
         else
                               rm -f conftest.class
-          if { echo "$as_me:37685: javac -target $target_version -d . conftest.java" >&5
+          if { echo "$as_me:37718: javac -target $target_version -d . conftest.java" >&5
                javac -target "$target_version" -d . conftest.java >&5 2>&1
              } \
              && test -f conftest.class \
              && expr `func_classfile_version conftest.class` '<=' $cfversion >/dev/null 2>&5; then
                         rm -f conftest.class
             rm -f conftestfail.class
-            if { echo "$as_me:37692: javac -target $target_version -source $source_version -d . conftest.java" >&5
+            if { echo "$as_me:37725: javac -target $target_version -source $source_version -d . conftest.java" >&5
                  javac -target "$target_version" -source "$source_version" -d . conftest.java >&5 2>&1
                } \
                && test -f conftest.class \
                && expr `func_classfile_version conftest.class` '<=' $cfversion >/dev/null 2>&5 \
-               && { echo "$as_me:37697: javac -target $target_version -d . conftestfail.java" >&5
+               && { echo "$as_me:37730: javac -target $target_version -d . conftestfail.java" >&5
                     javac -target "$target_version" -d . conftestfail.java >&5 2>&1
                   } \
                && test -f conftestfail.class \
-               && ! { echo "$as_me:37701: javac -target $target_version -source $source_version -d . conftestfail.java" >&5
+               && ! { echo "$as_me:37734: javac -target $target_version -source $source_version -d . conftestfail.java" >&5
                       javac -target "$target_version" -source "$source_version" -d . conftestfail.java >&5 2>&1
                     }; then
               CONF_JAVAC="javac -target $target_version -source $source_version"
@@ -37711,7 +37744,7 @@
             fi
           else
                                                 rm -f conftest.class
-            if { echo "$as_me:37714: javac -target $target_version -source $source_version -d . conftest.java" >&5
+            if { echo "$as_me:37747: javac -target $target_version -source $source_version -d . conftest.java" >&5
                  javac -target "$target_version" -source "$source_version" -d . conftest.java >&5 2>&1
                } \
                && test -f conftest.class \
@@ -38129,6 +38162,10 @@
   as_fn_error $? "conditional \"FLEX_CXX_WORKS\" was never defined.
 Usually this means the macro was only invoked conditionally." "$LINENO" 5
 fi
+if test -z "${ENABLE_EXAMPLES_TRUE}" && test -z "${ENABLE_EXAMPLES_FALSE}"; then
+  as_fn_error $? "conditional \"ENABLE_EXAMPLES\" was never defined.
+Usually this means the macro was only invoked conditionally." "$LINENO" 5
+fi
 if test -z "${GL_COND_LIBTOOL_TRUE}" && test -z "${GL_COND_LIBTOOL_FALSE}"; then
   as_fn_error $? "conditional \"GL_COND_LIBTOOL\" was never defined.
 Usually this means the macro was only invoked conditionally." "$LINENO" 5
#diff -ru bison-3.0.4.orig/Makefile.am bison-3.0.4/Makefile.am
#--- bison-3.0.4.orig/Makefile.am	2015-04-10 18:21:18.782550488 +0200
#+++ bison-3.0.4/Makefile.am	2015-04-10 18:23:34.412306149 +0200
#@@ -59,7 +59,9 @@
 include djgpp/local.mk
 include doc/local.mk
 include etc/local.mk
+if ENABLE_EXAMPLES
 include examples/local.mk
+endif
 include lib/local.mk
 include src/local.mk
 include tests/local.mk
diff -ru bison-3.0.4.orig/Makefile.in bison-3.0.4/Makefile.in
--- bison-3.0.4.orig/Makefile.in	2015-04-10 18:21:18.782550488 +0200
+++ bison-3.0.4/Makefile.in	2015-04-10 18:23:56.155600312 +0200
@@ -248,13 +248,29 @@
 POST_UNINSTALL = :
 build_triplet = @build@
 host_triplet = @host@
-check_PROGRAMS = $(am__EXEEXT_1) examples/mfcalc/mfcalc$(EXEEXT) \
-	examples/rpcalc/rpcalc$(EXEEXT)
+check_PROGRAMS = $(am__EXEEXT_1) $(am__EXEEXT_2)
 @CROSS_COMPILING_FALSE@am__append_1 = $(top_srcdir)/doc/bison.help
-@FLEX_CXX_WORKS_TRUE@am__append_2 = examples/calc++/calc++
-@FLEX_CXX_WORKS_TRUE@am__append_3 = examples/calc++/calc++.test
-@FLEX_CXX_WORKS_FALSE@am__append_4 = examples/calc++/calc++.test
-@LIBUNISTRING_COMPILE_UNIWIDTH_WIDTH_TRUE@am__append_5 = lib/uniwidth/width.c
+@ENABLE_EXAMPLES_TRUE@am__append_2 = $(extracted) \
+@ENABLE_EXAMPLES_TRUE@	examples/extracted.stamp \
+@ENABLE_EXAMPLES_TRUE@	$(calcxx_sources_generated) \
+@ENABLE_EXAMPLES_TRUE@	examples/calc++/calc++-parser.output \
+@ENABLE_EXAMPLES_TRUE@	examples/calc++/calc++-parser.stamp \
+@ENABLE_EXAMPLES_TRUE@	examples/calc++/calc++-scanner.cc \
+@ENABLE_EXAMPLES_TRUE@	examples/mfcalc/mfcalc.[ch] \
+@ENABLE_EXAMPLES_TRUE@	examples/mfcalc/mfcalc.output \
+@ENABLE_EXAMPLES_TRUE@	examples/rpcalc/rpcalc.[ch] \
+@ENABLE_EXAMPLES_TRUE@	examples/rpcalc/rpcalc.output
+@ENABLE_EXAMPLES_TRUE@am__append_3 = .yy .stamp
+@ENABLE_EXAMPLES_TRUE@@FLEX_CXX_WORKS_TRUE@am__append_4 = examples/calc++/calc++
+@ENABLE_EXAMPLES_TRUE@@FLEX_CXX_WORKS_TRUE@am__append_5 = examples/calc++/calc++.test
+@ENABLE_EXAMPLES_TRUE@@FLEX_CXX_WORKS_FALSE@am__append_6 = examples/calc++/calc++.test
+@ENABLE_EXAMPLES_TRUE@am__append_7 = $(mfcalc_sources) \
+@ENABLE_EXAMPLES_TRUE@	$(rpcalc_sources)
+@ENABLE_EXAMPLES_TRUE@am__append_8 = examples/mfcalc/mfcalc \
+@ENABLE_EXAMPLES_TRUE@	examples/rpcalc/rpcalc
+@ENABLE_EXAMPLES_TRUE@am__append_9 = examples/mfcalc/mfcalc.test \
+@ENABLE_EXAMPLES_TRUE@	examples/rpcalc/rpcalc.test
+@LIBUNISTRING_COMPILE_UNIWIDTH_WIDTH_TRUE@am__append_10 = lib/uniwidth/width.c
 bin_PROGRAMS = src/bison$(EXEEXT)
 subdir = .
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
@@ -356,7 +372,7 @@
 am__configure_deps = $(am__aclocal_m4_deps) $(CONFIGURE_DEPENDENCIES) \
 	$(ACLOCAL_M4)
 DIST_COMMON = $(srcdir)/Makefile.am $(top_srcdir)/configure \
-	$(am__configure_deps) $(dist_noinst_SCRIPTS) \
+	$(am__configure_deps) $(am__dist_noinst_SCRIPTS_DIST) \
 	$(srcdir)/doc/version.texi $(srcdir)/doc/stamp-vti \
 	$(dist_doc_DATA) $(dist_m4sugar_DATA) $(dist_pkgdata_DATA) \
 	$(dist_xslt_DATA) $(am__DIST_COMMON)
@@ -473,15 +489,18 @@
 @ENABLE_YACC_TRUE@am_lib_liby_a_OBJECTS = lib/main.$(OBJEXT) \
 @ENABLE_YACC_TRUE@	lib/yyerror.$(OBJEXT)
 lib_liby_a_OBJECTS = $(am_lib_liby_a_OBJECTS)
-@FLEX_CXX_WORKS_TRUE@am__EXEEXT_1 = examples/calc++/calc++$(EXEEXT)
+@ENABLE_EXAMPLES_TRUE@@FLEX_CXX_WORKS_TRUE@am__EXEEXT_1 = examples/calc++/calc++$(EXEEXT)
+@ENABLE_EXAMPLES_TRUE@am__EXEEXT_2 = examples/mfcalc/mfcalc$(EXEEXT) \
+@ENABLE_EXAMPLES_TRUE@	examples/rpcalc/rpcalc$(EXEEXT)
 PROGRAMS = $(bin_PROGRAMS)
-am__objects_2 = examples/calc++/examples_calc___calc__-calc++-driver.$(OBJEXT) \
-	examples/calc++/examples_calc___calc__-calc++-scanner.$(OBJEXT) \
-	examples/calc++/examples_calc___calc__-calc++.$(OBJEXT)
-am__objects_3 = examples/calc++/examples_calc___calc__-calc++-parser.$(OBJEXT)
-am__objects_4 = $(am__objects_2) $(am__objects_3)
-@FLEX_CXX_WORKS_TRUE@nodist_examples_calc___calc___OBJECTS =  \
-@FLEX_CXX_WORKS_TRUE@	$(am__objects_4)
+@ENABLE_EXAMPLES_TRUE@am__objects_2 = examples/calc++/examples_calc___calc__-calc++-driver.$(OBJEXT) \
+@ENABLE_EXAMPLES_TRUE@	examples/calc++/examples_calc___calc__-calc++-scanner.$(OBJEXT) \
+@ENABLE_EXAMPLES_TRUE@	examples/calc++/examples_calc___calc__-calc++.$(OBJEXT)
+@ENABLE_EXAMPLES_TRUE@am__objects_3 = examples/calc++/examples_calc___calc__-calc++-parser.$(OBJEXT)
+@ENABLE_EXAMPLES_TRUE@am__objects_4 = $(am__objects_2) \
+@ENABLE_EXAMPLES_TRUE@	$(am__objects_3)
+@ENABLE_EXAMPLES_TRUE@@FLEX_CXX_WORKS_TRUE@nodist_examples_calc___calc___OBJECTS =  \
+@ENABLE_EXAMPLES_TRUE@@FLEX_CXX_WORKS_TRUE@	$(am__objects_4)
 examples_calc___calc___OBJECTS =  \
 	$(nodist_examples_calc___calc___OBJECTS)
 examples_calc___calc___LDADD = $(LDADD)
@@ -490,17 +509,17 @@
 examples_calc___calc___LINK = $(CXXLD) \
 	$(examples_calc___calc___CXXFLAGS) $(CXXFLAGS) $(AM_LDFLAGS) \
 	$(LDFLAGS) -o $@
-am__objects_5 =  \
-	examples/mfcalc/examples_mfcalc_mfcalc-mfcalc.$(OBJEXT)
-am__objects_6 = $(am__objects_5)
-nodist_examples_mfcalc_mfcalc_OBJECTS = $(am__objects_6)
+@ENABLE_EXAMPLES_TRUE@am__objects_5 = examples/mfcalc/examples_mfcalc_mfcalc-mfcalc.$(OBJEXT)
+@ENABLE_EXAMPLES_TRUE@am__objects_6 = $(am__objects_5)
+@ENABLE_EXAMPLES_TRUE@nodist_examples_mfcalc_mfcalc_OBJECTS =  \
+@ENABLE_EXAMPLES_TRUE@	$(am__objects_6)
 examples_mfcalc_mfcalc_OBJECTS =  \
 	$(nodist_examples_mfcalc_mfcalc_OBJECTS)
 examples_mfcalc_mfcalc_DEPENDENCIES =
-am__objects_7 =  \
-	examples/rpcalc/examples_rpcalc_rpcalc-rpcalc.$(OBJEXT)
-am__objects_8 = $(am__objects_7)
-nodist_examples_rpcalc_rpcalc_OBJECTS = $(am__objects_8)
+@ENABLE_EXAMPLES_TRUE@am__objects_7 = examples/rpcalc/examples_rpcalc_rpcalc-rpcalc.$(OBJEXT)
+@ENABLE_EXAMPLES_TRUE@am__objects_8 = $(am__objects_7)
+@ENABLE_EXAMPLES_TRUE@nodist_examples_rpcalc_rpcalc_OBJECTS =  \
+@ENABLE_EXAMPLES_TRUE@	$(am__objects_8)
 examples_rpcalc_rpcalc_OBJECTS =  \
 	$(nodist_examples_rpcalc_rpcalc_OBJECTS)
 examples_rpcalc_rpcalc_DEPENDENCIES =
@@ -528,6 +547,7 @@
 src_bison_DEPENDENCIES = lib/libbison.a $(am__DEPENDENCIES_1)
 src_bison_LINK = $(CCLD) $(src_bison_CFLAGS) $(CFLAGS) $(AM_LDFLAGS) \
 	$(LDFLAGS) -o $@
+am__dist_noinst_SCRIPTS_DIST = examples/extexi examples/test
 SCRIPTS = $(bin_SCRIPTS) $(dist_noinst_SCRIPTS) \
 	$(nodist_noinst_SCRIPTS)
 AM_V_P = $(am__v_P_@AM_V@)
@@ -2145,7 +2165,7 @@
 	djgpp/subpipe.h djgpp/testsuite.sed doc/refcard.tex \
 	$(top_srcdir)/doc/bison.help $(dist_man_MANS:.1=.x) $(FIGS_GV) \
 	$(FIGS_GV:.gv=.txt) $(FIGS_GV:.gv=.eps) $(FIGS_GV:.gv=.pdf) \
-	$(FIGS_GV:.gv=.png) doc/Doxyfile.in $(am__append_4) \
+	$(FIGS_GV:.gv=.png) doc/Doxyfile.in $(am__append_6) \
 	lib/alignof.h lib/alloca.in.h \
 	$(top_srcdir)/build-aux/announce-gen lib/argmatch.h \
 	lib/c-strcaseeq.h lib/calloc.c lib/cloexec.h lib/close.c \
@@ -2249,27 +2269,20 @@
 # a developer might naively reference .version in a test case while the bison
 # executable still compiles with VERSION, and so the test case might fail or
 # pass incorrectly.
-BUILT_SOURCES = $(mfcalc_sources) $(rpcalc_sources) $(ALLOCA_H) \
-	lib/configmake.h $(ERRNO_H) lib/fcntl.h $(FLOAT_H) $(GETOPT_H) \
-	lib/inttypes.h lib/math.h $(SCHED_H) lib/signal.h \
-	lib/arg-nonnull.h lib/c++defs.h lib/warn-on-use.h lib/spawn.h \
-	$(STDBOOL_H) $(STDDEF_H) $(STDINT_H) lib/stdio.h lib/stdlib.h \
-	lib/string.h lib/sys/stat.h lib/sys/time.h lib/sys/types.h \
-	lib/sys/wait.h lib/time.h lib/unistd.h \
-	$(LIBUNISTRING_UNITYPES_H) $(LIBUNISTRING_UNIWIDTH_H) \
-	lib/wchar.h lib/wctype.h src/parse-gram.c src/parse-gram.h \
-	src/scan-code.c src/scan-gram.c src/scan-skel.c \
-	$(top_srcdir)/.version
+BUILT_SOURCES = $(am__append_7) $(ALLOCA_H) lib/configmake.h \
+	$(ERRNO_H) lib/fcntl.h $(FLOAT_H) $(GETOPT_H) lib/inttypes.h \
+	lib/math.h $(SCHED_H) lib/signal.h lib/arg-nonnull.h \
+	lib/c++defs.h lib/warn-on-use.h lib/spawn.h $(STDBOOL_H) \
+	$(STDDEF_H) $(STDINT_H) lib/stdio.h lib/stdlib.h lib/string.h \
+	lib/sys/stat.h lib/sys/time.h lib/sys/types.h lib/sys/wait.h \
+	lib/time.h lib/unistd.h $(LIBUNISTRING_UNITYPES_H) \
+	$(LIBUNISTRING_UNIWIDTH_H) lib/wchar.h lib/wctype.h \
+	src/parse-gram.c src/parse-gram.h src/scan-code.c \
+	src/scan-gram.c src/scan-skel.c $(top_srcdir)/.version
 CLEANFILES = doc/refcard.pdf $(FIGS_GV:.gv=.eps) $(FIGS_GV:.gv=.pdf) \
-	$(FIGS_GV:.gv=.png) doc/Doxyfile $(extracted) \
-	examples/extracted.stamp $(calcxx_sources_generated) \
-	examples/calc++/calc++-parser.output \
-	examples/calc++/calc++-parser.stamp \
-	examples/calc++/calc++-scanner.cc examples/mfcalc/mfcalc.[ch] \
-	examples/mfcalc/mfcalc.output examples/rpcalc/rpcalc.[ch] \
-	examples/rpcalc/rpcalc.output lib/configmake.h \
-	lib/configmake.h-t lib/charset.alias lib/ref-add.sed \
-	lib/ref-del.sed
+	$(FIGS_GV:.gv=.png) doc/Doxyfile $(am__append_2) \
+	lib/configmake.h lib/configmake.h-t lib/charset.alias \
+	lib/ref-add.sed lib/ref-del.sed
 DISTCLEANFILES = tests/atconfig $(check_SCRIPTS)
 MOSTLYCLEANDIRS = lib/sys lib/sys
 MOSTLYCLEANFILES = $(top_srcdir)/doc/*.t lib/core lib/*.stackdump \
@@ -2289,10 +2302,9 @@
 	lib/unistd.h-t lib/unitypes.h lib/unitypes.h-t lib/uniwidth.h \
 	lib/uniwidth.h-t lib/wchar.h lib/wchar.h-t lib/wctype.h \
 	lib/wctype.h-t src/yacc
-SUFFIXES = .gv .eps .pdf .png .yy .stamp
+SUFFIXES = .gv .eps .pdf .png $(am__append_3)
 TESTS = $(dist_TESTS)
-dist_TESTS = $(am__append_3) examples/mfcalc/mfcalc.test \
-	examples/rpcalc/rpcalc.test
+dist_TESTS = $(am__append_5) $(am__append_9)
 noinst_LIBRARIES = lib/libbison.a
 dist_pkgdata_DATA = \
   data/README                                   \
@@ -2364,59 +2376,59 @@
 	   -e 's,@top_srcdir\@,$(top_srcdir),g'
 
 nodist_noinst_SCRIPTS = etc/bench.pl
-dist_noinst_SCRIPTS = examples/extexi examples/test
-TEST_LOG_COMPILER = $(top_srcdir)/examples/test
-AM_CXXFLAGS = \
-  $(WARN_CXXFLAGS) $(WARN_CXXFLAGS_TEST) $(WERROR_CXXFLAGS)
-
-doc = $(top_srcdir)/doc/bison.texi
-extexi = $(top_srcdir)/examples/extexi
-@ENABLE_GCC_WARNINGS_TRUE@extexiFLAGS = --synclines
-extract = VERSION="$(VERSION)" $(PERL) $(extexi) $(extexiFLAGS) $(doc) --
-extracted = $(calcxx_extracted) $(mfcalc_extracted) \
-	$(rpcalc_extracted)
-calcxx_sources_extracted = \
-  examples/calc++/calc++-driver.cc                          \
-  examples/calc++/calc++-driver.hh                          \
-  examples/calc++/calc++-scanner.ll                         \
-  examples/calc++/calc++.cc
-
-calcxx_extracted = \
-  $(calcxx_sources_extracted)                   \
-  examples/calc++/calc++-parser.yy
-
-calcxx_sources_generated = \
-  examples/calc++/calc++-parser.cc                          \
-  examples/calc++/calc++-parser.hh                          \
-  examples/calc++/location.hh                               \
-  examples/calc++/position.hh                               \
-  examples/calc++/stack.hh
-
-calcxx_sources = \
-  $(calcxx_sources_extracted)                   \
-  $(calcxx_sources_generated)
-
-@FLEX_CXX_WORKS_TRUE@nodist_examples_calc___calc___SOURCES = \
-@FLEX_CXX_WORKS_TRUE@  $(calcxx_sources)
-
-@FLEX_CXX_WORKS_TRUE@examples_calc___calc___CPPFLAGS = -I$(top_builddir)/examples/calc++
-@FLEX_CXX_WORKS_TRUE@examples_calc___calc___CXXFLAGS = $(AM_CXXFLAGS) $(FLEX_SCANNER_CXXFLAGS)
-calcxxdir = $(docdir)/examples/calc++
-calcxx_DATA = $(calcxx_extracted)
-mfcalc_extracted = examples/mfcalc/calc.h examples/mfcalc/mfcalc.y
-mfcalc_sources = $(mfcalc_extracted)
-examples_mfcalc_mfcalc_LDADD = -lm
-nodist_examples_mfcalc_mfcalc_SOURCES = $(mfcalc_sources)
-examples_mfcalc_mfcalc_CPPFLAGS = -I$(top_builddir)/examples/mfcalc
-mfcalcdir = $(docdir)/examples/mfcalc
-mfcalc_DATA = $(mfcalc_extracted)
-rpcalc_extracted = examples/rpcalc/rpcalc.y
-rpcalc_sources = $(rpcalc_extracted)
-examples_rpcalc_rpcalc_LDADD = -lm
-nodist_examples_rpcalc_rpcalc_SOURCES = $(rpcalc_sources)
-examples_rpcalc_rpcalc_CPPFLAGS = -I$(top_builddir)/examples/rpcalc
-rpcalcdir = $(docdir)/examples/rpcalc
-rpcalc_DATA = $(rpcalc_extracted)
+@ENABLE_EXAMPLES_TRUE@dist_noinst_SCRIPTS = examples/extexi examples/test
+@ENABLE_EXAMPLES_TRUE@TEST_LOG_COMPILER = $(top_srcdir)/examples/test
+@ENABLE_EXAMPLES_TRUE@AM_CXXFLAGS = \
+@ENABLE_EXAMPLES_TRUE@  $(WARN_CXXFLAGS) $(WARN_CXXFLAGS_TEST) $(WERROR_CXXFLAGS)
+
+@ENABLE_EXAMPLES_TRUE@doc = $(top_srcdir)/doc/bison.texi
+@ENABLE_EXAMPLES_TRUE@extexi = $(top_srcdir)/examples/extexi
+@ENABLE_EXAMPLES_TRUE@@ENABLE_GCC_WARNINGS_TRUE@extexiFLAGS = --synclines
+@ENABLE_EXAMPLES_TRUE@extract = VERSION="$(VERSION)" $(PERL) $(extexi) $(extexiFLAGS) $(doc) --
+@ENABLE_EXAMPLES_TRUE@extracted = $(calcxx_extracted) \
+@ENABLE_EXAMPLES_TRUE@	$(mfcalc_extracted) $(rpcalc_extracted)
+@ENABLE_EXAMPLES_TRUE@calcxx_sources_extracted = \
+@ENABLE_EXAMPLES_TRUE@  examples/calc++/calc++-driver.cc                          \
+@ENABLE_EXAMPLES_TRUE@  examples/calc++/calc++-driver.hh                          \
+@ENABLE_EXAMPLES_TRUE@  examples/calc++/calc++-scanner.ll                         \
+@ENABLE_EXAMPLES_TRUE@  examples/calc++/calc++.cc
+
+@ENABLE_EXAMPLES_TRUE@calcxx_extracted = \
+@ENABLE_EXAMPLES_TRUE@  $(calcxx_sources_extracted)                   \
+@ENABLE_EXAMPLES_TRUE@  examples/calc++/calc++-parser.yy
+
+@ENABLE_EXAMPLES_TRUE@calcxx_sources_generated = \
+@ENABLE_EXAMPLES_TRUE@  examples/calc++/calc++-parser.cc                          \
+@ENABLE_EXAMPLES_TRUE@  examples/calc++/calc++-parser.hh                          \
+@ENABLE_EXAMPLES_TRUE@  examples/calc++/location.hh                               \
+@ENABLE_EXAMPLES_TRUE@  examples/calc++/position.hh                               \
+@ENABLE_EXAMPLES_TRUE@  examples/calc++/stack.hh
+
+@ENABLE_EXAMPLES_TRUE@calcxx_sources = \
+@ENABLE_EXAMPLES_TRUE@  $(calcxx_sources_extracted)                   \
+@ENABLE_EXAMPLES_TRUE@  $(calcxx_sources_generated)
+
+@ENABLE_EXAMPLES_TRUE@@FLEX_CXX_WORKS_TRUE@nodist_examples_calc___calc___SOURCES = \
+@ENABLE_EXAMPLES_TRUE@@FLEX_CXX_WORKS_TRUE@  $(calcxx_sources)
+
+@ENABLE_EXAMPLES_TRUE@@FLEX_CXX_WORKS_TRUE@examples_calc___calc___CPPFLAGS = -I$(top_builddir)/examples/calc++
+@ENABLE_EXAMPLES_TRUE@@FLEX_CXX_WORKS_TRUE@examples_calc___calc___CXXFLAGS = $(AM_CXXFLAGS) $(FLEX_SCANNER_CXXFLAGS)
+@ENABLE_EXAMPLES_TRUE@calcxxdir = $(docdir)/examples/calc++
+@ENABLE_EXAMPLES_TRUE@calcxx_DATA = $(calcxx_extracted)
+@ENABLE_EXAMPLES_TRUE@mfcalc_extracted = examples/mfcalc/calc.h examples/mfcalc/mfcalc.y
+@ENABLE_EXAMPLES_TRUE@mfcalc_sources = $(mfcalc_extracted)
+@ENABLE_EXAMPLES_TRUE@examples_mfcalc_mfcalc_LDADD = -lm
+@ENABLE_EXAMPLES_TRUE@nodist_examples_mfcalc_mfcalc_SOURCES = $(mfcalc_sources)
+@ENABLE_EXAMPLES_TRUE@examples_mfcalc_mfcalc_CPPFLAGS = -I$(top_builddir)/examples/mfcalc
+@ENABLE_EXAMPLES_TRUE@mfcalcdir = $(docdir)/examples/mfcalc
+@ENABLE_EXAMPLES_TRUE@mfcalc_DATA = $(mfcalc_extracted)
+@ENABLE_EXAMPLES_TRUE@rpcalc_extracted = examples/rpcalc/rpcalc.y
+@ENABLE_EXAMPLES_TRUE@rpcalc_sources = $(rpcalc_extracted)
+@ENABLE_EXAMPLES_TRUE@examples_rpcalc_rpcalc_LDADD = -lm
+@ENABLE_EXAMPLES_TRUE@nodist_examples_rpcalc_rpcalc_SOURCES = $(rpcalc_sources)
+@ENABLE_EXAMPLES_TRUE@examples_rpcalc_rpcalc_CPPFLAGS = -I$(top_builddir)/examples/rpcalc
+@ENABLE_EXAMPLES_TRUE@rpcalcdir = $(docdir)/examples/rpcalc
+@ENABLE_EXAMPLES_TRUE@rpcalc_DATA = $(rpcalc_extracted)
 
 # Implementation of bitsets.
 
@@ -2441,7 +2453,7 @@
 	lib/progname.c lib/quotearg.c lib/sig-handler.c lib/size_max.h \
 	lib/spawn-pipe.h lib/spawn-pipe.c lib/w32spawn.h \
 	lib/glthread/threadlib.c lib/unistd.c lib/dup-safer.c \
-	lib/fd-safer.c lib/pipe-safer.c $(am__append_5) \
+	lib/fd-safer.c lib/pipe-safer.c $(am__append_10) \
 	lib/wait-process.h lib/wait-process.c lib/wctype-h.c \
 	lib/xmalloc.c lib/xalloc-die.c lib/xconcat-filename.c \
 	lib/xsize.h lib/xsize.c lib/xstrndup.h lib/xstrndup.c \
@@ -5328,31 +5340,31 @@
 # configure, because the former is way faster than the latter.
 doc/Doxyfile: $(top_srcdir)/doc/Doxyfile.in
 	$(AM_V_GEN) $(edit) $(top_srcdir)/doc/Doxyfile.in >doc/Doxyfile
-examples/extracted.stamp: $(doc) $(extexi)
-	$(AM_V_GEN)rm -f $@ $@.tmp
-	$(AM_V_at)touch $@.tmp
-	$(AM_V_at)$(extract) $(extracted)
-	$(AM_V_at)mv $@.tmp $@
-
-$(extracted): examples/extracted.stamp
-	@test -f $@ || rm -f examples/extracted.stamp
-	@test -f $@ || $(MAKE) $(AM_MAKEFLAGS) examples/extracted.stamp
+@ENABLE_EXAMPLES_TRUE@examples/extracted.stamp: $(doc) $(extexi)
+@ENABLE_EXAMPLES_TRUE@	$(AM_V_GEN)rm -f $@ $@.tmp
+@ENABLE_EXAMPLES_TRUE@	$(AM_V_at)touch $@.tmp
+@ENABLE_EXAMPLES_TRUE@	$(AM_V_at)$(extract) $(extracted)
+@ENABLE_EXAMPLES_TRUE@	$(AM_V_at)mv $@.tmp $@
+
+@ENABLE_EXAMPLES_TRUE@$(extracted): examples/extracted.stamp
+@ENABLE_EXAMPLES_TRUE@	@test -f $@ || rm -f examples/extracted.stamp
+@ENABLE_EXAMPLES_TRUE@	@test -f $@ || $(MAKE) $(AM_MAKEFLAGS) examples/extracted.stamp
 
 # Don't depend on $(BISON) otherwise we would rebuild these files
 # in srcdir, including during distcheck, which is forbidden.
-examples/calc++/calc++-parser.stamp: $(BISON_IN)
-.yy.stamp:
-	$(AM_V_YACC)rm -f $@
-	$(AM_V_at)touch $@.tmp
-	$(AM_V_at)$(YACCCOMPILE) -o $*.cc $<
-	$(AM_V_at)mv -f $@.tmp $@
-
-$(calcxx_sources_generated): examples/calc++/calc++-parser.stamp
-	@test -f $@ || rm -f examples/calc++/calc++-parser.stamp
-	@test -f $@ || $(MAKE) $(AM_MAKEFLAGS) examples/calc++/calc++-parser.stamp
+@ENABLE_EXAMPLES_TRUE@examples/calc++/calc++-parser.stamp: $(BISON_IN)
+@ENABLE_EXAMPLES_TRUE@.yy.stamp:
+@ENABLE_EXAMPLES_TRUE@	$(AM_V_YACC)rm -f $@
+@ENABLE_EXAMPLES_TRUE@	$(AM_V_at)touch $@.tmp
+@ENABLE_EXAMPLES_TRUE@	$(AM_V_at)$(YACCCOMPILE) -o $*.cc $<
+@ENABLE_EXAMPLES_TRUE@	$(AM_V_at)mv -f $@.tmp $@
+
+@ENABLE_EXAMPLES_TRUE@$(calcxx_sources_generated): examples/calc++/calc++-parser.stamp
+@ENABLE_EXAMPLES_TRUE@	@test -f $@ || rm -f examples/calc++/calc++-parser.stamp
+@ENABLE_EXAMPLES_TRUE@	@test -f $@ || $(MAKE) $(AM_MAKEFLAGS) examples/calc++/calc++-parser.stamp
 
 # Avoid using BUILT_SOURCES which is too global.
-$(examples_calc___calc___OBJECTS): $(calcxx_sources_generated)
+@ENABLE_EXAMPLES_TRUE@$(examples_calc___calc___OBJECTS): $(calcxx_sources_generated)
 
 # We need the following in order to create <alloca.h> when the system
 # doesn't have one that works with the given compiler.
